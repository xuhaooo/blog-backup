# 浅析 URL
> 回望李爵士发明的三样东西：WWW = URL + HTTP + HTML<br/>
> 这其中的 URL 是什么东西呢？</br>
> 这一切还得从 IP 讲起。。。

## IP (Internet Protocol)
### 1. IP 主要约定了两件事情
- 如何定位一台设备
- 如何封装数据报文，以跟其他设备交流（具体内容我们不关心）
> 只要你在换联网中，你就至少拥有一个独特的 IP

### 2. IP 分为内网 IP 和外网 IP
![内网与外网.jpg](https://i.loli.net/2020/12/20/wXW5DZxKyV89HsL.jpg)
#### 如何获取外网 IP
- 从电信租用宽带，一年一千多
- 买一个光猫，进行光电转换，把光信号转换成路由器能理解的电信号，反之一样
- 买一个路由器，然后用电脑和手机分别连接上路由器广播出来的无线WIFI
- 只要路由器连上电信的服务器，那么路由器就会有一个「外网IP」，比如「14.17.32.211」就是一个外网IP。这就是你在互联网中的地址，你的所有设备都是这一个外网 IP
- 但是如果你重启路由器，那么你很有「可能」被重新分配一个「外网IP」，也就是说你的路由器没有「固定的外网IP」
- 但是有个问题，你的路由器的外网 IP 如果是14.17.32.211，那么你的手机和电脑的IP又是什么呢？答案是「内网IP」

#### 路由器的功能
- 现在路由器有两个IP，一个外网IP和一个内网IP(自己分配给自己的)
- 内网中的设备可以互相访问，但是不能直接访问外网
- 内网设备想要访问外网，就必须经过路由器的中转
- 外网中的设备可以互相访问，但是无法访问你的内网
- 外网设备想要把内容送到内网，也必须通过路由器
- 也就是说内网和外网像两个隔绝的空间，无法互通，唯一的联通点就是路由器
- 所以路由器有时候也被叫做「网关」

#### 几个特殊的 IP
- 127.0.0.1 表示自己
- localhost 也表示自己，通过 hosts 文件指定为自己，可以更改添加
- 0.0.0.0 不表示任何设备
- 想查看自己的外网 IP 可以通过：https://ip138.com/

## 端口（port）
> IP 有了，还需要什么呢？还需要「端口」<br>
> 一台机器可以提供很多服务<br>
> 每个服务一个号码，这个号码就叫端口号（port）

### 1. 端口（port）
#### 一个比喻
- 麦当劳提供两个窗口，一号快餐，二号咖啡
- 你去快餐窗口点咖啡会被拒绝，让你去两一个窗口
- 你去咖啡窗口点快餐结果一样
#### 一台机器可以提供不同服务
- 要提供 HTTP 服务最好使用 80 端口
- 要提供 HTTP 服务最好使用 443 端口
- 要提供 FTP 服务最好使用 21 端口
- 一个 65535 个端口（基本够用）
- 我怎么知道应该用什么端口（维基百科）

### 2. 端口使用还有什么规则
- 0 到 1023 号端口是留给系统使用的
- 你只有拥有了管理员权限后，才能使用这 1024 个端口
- 其他端口可以给普通用户使用
- 比如 http-server 默认使用 8080 端口
- 一个端口如果被占用，你就只能换一个端口

### 3. 总之
- IP 和端口缺一不可
- IP 用来定位一个设备，端口用来定位设备的一个服务


## 域名
### 1. 域名，就是  IP 的别称
- 你可以通过`ping 域名`的方式得到该域名对应的 IP
#### 知识点
- 一个域名可以对应不同的 IP；这个叫做负载均衡，防止一台机器扛不住
- 一个 IP 可以对应不同域名；这个叫做共享主机，一般穷开发者会这么做

### 2. 域名与 IP 的对应关系
> DNS（Domain Name System）<br>
> 当你在地址栏输入 qq.com，回车
#### 过程
- 你的 Chrome 浏览器会向电信/联通提供的 DNS 服务器询问 qq.com 对应的 IP
- 你也可以通过终端查询域名对应的是什么 IP（`nslookup qq.com`）
- 电信/联通会回答一个 IP（具体过程很复杂，不研究）
- 然后 Chrome 才会向对应 IP 的 80/433 端口发送请求
- 请求内容是查看 qq.com 的首页
#### 为什么是 80 或 433 端口（默认就有不需要写）
- 服务器默认用 80 提供 http 服务
- 服务器默认用 433 提供 https 服务
- 你可以在开发者工具里看到具体的端口，Network 栏

### 3. 题外话
#### www
www.baidu.com 和 baidu.com 是同一个域名吗？并不是
#### 它们是什么关系
- com 是顶级域名（company）
- baidu.com 是二级域名（俗称一级域名）
- www.baidu.com 是三级域名（俗称二级域名）
#### 它们是父子关系
- github.io 把子域名 xxx.github.io 免费给你使用
- 所以你应该知道 www.baidu.com 和 baidu.com 可以不是同一家公司，当然也可以是
- www 是多余的吗？是的


## 路径
### 如何请求不同的页面
> 同一个服务器上使用不同的路径，就可以得到不同的页面
- 注意：路径是没有必要有后缀的
- https://developer.mozilla.org/zh-CN/docs/Web/HTML
- https://developer.mozilla.org/zh-CN/docs/Web/CSS
### 工具
- 使用 Chrome 开发者工具 Network 面板可以看到区别


## 查询参数
> 同一个页面，更近一步，我要不同内容可以吗？
### 查询参数可以做到
- www.baidu.com/s?wd=hi
- www.baidu.com/s?wd=hello
- 同一个页面不同的查询结果


## 锚点
> 同一个内容，不同位置
### 锚点可以做到
- https://developer.mozilla.org/zh-CN/docs/Web/CSS#参考书
- https://developer.mozilla.org/zh-CN/docs/Web/CSS#就教程
### 注意
- 锚点看起来有中文，实际不支持中文，用字符表示中文一样意思
- “#参考书”会变成 #%E5%8F%82%E8%80%83%E4%B9%A6
- 锚点是无法在 Network 面板看到的，因为锚点不会传给服务器，它只是你本地的不同内容而已，告诉服务器干什么呢


## URL（统一资源定位符） 完整内容
> Finally !!<br>

**协议 + 域名或 IP + 端口号 + 路径 + 查询字符串 + 锚点**

### URL 举例
![URL构成.jpg](https://i.loli.net/2020/12/20/EXZeBJx2kqRHrvA.jpg)
- 就算没写，你也应该知道端口
- HTTPS 默认端口 443


## HTTP（协议）
- 基于 TCP 和 IP 两个协议搭建
- IP 协议，定位设备
- HTTP 协议，规定如何传输页面


## curl 命令
### 用 curl 可以发 HTTP 请求
- Chrome 也可以发请求啊干嘛用 curl 发请求啊
- 因为 Chrome 做的事情太多了，让你看不清楚真相
- curl -v http://baidu.com (verbose啰嗦)
- curl -s -v -- https://www.baidu.com

### 理解以下概念
> curl 之后出来的一大段注释也有写
- url 会被 curl 工具重写，先请求 DNS 获得 IP（因为加入了 -s -V 等参数）
- 先进行 TCP 连接，TCP 连接成功后，开始发送 HTTP 请求
- 请求内容看一眼
- 响应内容看一眼
- 响应结束后，关闭 TCP 连接（看不出来）
- 真正结束

### HTTP
- 规定请求的格式是什么，响应的格式是什么
- 即，规定了如何写里面的请求的几行，以及如何返回那几十行响应，的这么一个规则（文件）

